import java.io.*;
import java.util.*;

class Contato {
    private String nome;
    private String telefone;

    public Contato(String nome, String telefone) {
        this.nome = nome;
        this.telefone = telefone;
    }

    public String getNome() {
        return nome;
    }

    public String getTelefone() {
        return telefone;
    }

    @Override
    public String toString() {
        return nome + " - " + telefone;
    }
}

public class Agenda {
    private static final String ARQUIVO = "agenda.txt";
    private static ArrayList<Contato> contatos = new ArrayList<>();

    public static void main(String[] args) {
        carregarContatos();

        Scanner sc = new Scanner(System.in);
        int opcao;

        do {
            System.out.println("\n===== AGENDA DE CONTATOS =====");
            System.out.println("1. Adicionar contato");
            System.out.println("2. Listar contatos");
            System.out.println("3. Sair");
            System.out.print("Escolha uma opção: ");
            opcao = sc.nextInt();
            sc.nextLine();

            switch (opcao) {
                case 1:
                    adicionarContato(sc);
                    break;
                case 2:
                    listarContatos();
                    break;
                case 3:
                    salvarContatos();
                    System.out.println("Contatos salvos. Encerrando...");
                    break;
                default:
                    System.out.println("Opção inválida!");
            }
        } while (opcao != 3);

        sc.close();
    }

    private static void adicionarContato(Scanner sc) {
        System.out.print("Nome: ");
        String nome = sc.nextLine();
        System.out.print("Telefone: ");
        String telefone = sc.nextLine();

        contatos.add(new Contato(nome, telefone));
        System.out.println("Contato adicionado!");
    }

    private static void listarContatos() {
        if (contatos.isEmpty()) {
            System.out.println("Nenhum contato cadastrado.");
        } else {
            System.out.println("\n--- Lista de Contatos ---");
            for (Contato c : contatos) {
                System.out.println(c);
            }
        }
    }

    private static void salvarContatos() {
        try (BufferedWriter writer = new BufferedWriter(new FileWriter(ARQUIVO))) {
            for (Contato c : contatos) {
                writer.write(c.getNome() + ";" + c.getTelefone());
                writer.newLine();
            }
        } catch (IOException e) {
            System.out.println("Erro ao salvar contatos: " + e.getMessage());
        }
    }

    private static void carregarContatos() {
        File file = new File(ARQUIVO);
        if (file.exists()) {
            try (BufferedReader reader = new BufferedReader(new FileReader(file))) {
                String linha;
                while ((linha = reader.readLine()) != null) {
                    String[] dados = linha.split(";");
                    if (dados.length == 2) {
                        contatos.add(new Contato(dados[0], dados[1]));
                    }
                }
                System.out.println("Contatos carregados com sucesso!");
            } catch (IOException e) {
                System.out.println("Erro ao carregar contatos: " + e.getMessage());
            }
        }
    }
}
